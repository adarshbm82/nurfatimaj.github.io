<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Projects | Nurfatima Jandarova</title>
    <link>https://nurfatimaj.com/project/</link>
      <atom:link href="https://nurfatimaj.com/project/index.xml" rel="self" type="application/rss+xml" />
    <description>Projects</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><lastBuildDate>Wed, 25 Mar 2020 15:00:08 +0100</lastBuildDate>
    <image>
      <url>img/map[gravatar:%!s(bool=false) shape:circle]</url>
      <title>Projects</title>
      <link>https://nurfatimaj.com/project/</link>
    </image>
    
    <item>
      <title>Covid-19 in Italy in graphs</title>
      <link>https://nurfatimaj.com/project/covid-19/</link>
      <pubDate>Wed, 25 Mar 2020 15:00:08 +0100</pubDate>
      <guid>https://nurfatimaj.com/project/covid-19/</guid>
      <description>


&lt;p&gt;Dataset source: &lt;a href=&#34;https://github.com/pcm-dpc/COVID-19&#34;&gt;github repository of the Department of Civil Protection&lt;/a&gt;&lt;/p&gt;
&lt;div id=&#34;setup&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Setup&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tidyverse)
library(lubridate)
library(sf)
library(gganimate)

data_file &amp;lt;- &amp;#39;~/Downloads/COVID-19/dati-regioni/dpc-covid19-ita-regioni.csv&amp;#39;
shape_dsn &amp;lt;- &amp;#39;~/Downloads/italian-maps-shapefiles/italy-with-regions/&amp;#39;

df &amp;lt;- read_csv(data_file)
shape &amp;lt;- read_sf(dsn = shape_dsn)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It is also helpful to reorder the regions based on north-south scale.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;df &amp;lt;- df %&amp;gt;% mutate(distance = sqrt(lat^2 + long^2), 
                    regions = fct_reorder(denominazione_regione, desc(distance)))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Since the hour information is useless, letâ€™s remove it&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;df &amp;lt;- df %&amp;gt;% mutate(date = date(data)) %&amp;gt;% select(-data)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now, I need to convert the dataset into simple features collection supplying the &lt;code&gt;long&lt;/code&gt; and &lt;code&gt;lat&lt;/code&gt; as point coordinates.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;df_sf &amp;lt;- df %&amp;gt;% st_as_sf(coords = c(&amp;#39;long&amp;#39;, &amp;#39;lat&amp;#39;), crs = 4326, agr = &amp;#39;constant&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And some settings for the plots&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;theme_set(theme_minimal())
theme_update(legend.position = &amp;#39;bottom&amp;#39;)
options(ggplot2.continuous.colour = &amp;#39;Spectral&amp;#39;)
options(ggplot2.continuous.fill = &amp;#39;Spectral&amp;#39;)
myColourPalette &amp;lt;- c(&amp;#39;#67001f&amp;#39;,&amp;#39;#b2182b&amp;#39;,&amp;#39;#d6604d&amp;#39;,&amp;#39;#f4a582&amp;#39;,&amp;#39;#fddbc7&amp;#39;,&amp;#39;#f7f7f7&amp;#39;,&amp;#39;#d1e5f0&amp;#39;,&amp;#39;#92c5de&amp;#39;,&amp;#39;#4393c3&amp;#39;,&amp;#39;#2166ac&amp;#39;,
                     &amp;#39;#053061&amp;#39;, &amp;#39;white&amp;#39;, &amp;#39;#40004b&amp;#39;,&amp;#39;#762a83&amp;#39;,&amp;#39;#9970ab&amp;#39;,&amp;#39;#c2a5cf&amp;#39;,&amp;#39;#e7d4e8&amp;#39;,&amp;#39;#f7f7f7&amp;#39;,&amp;#39;#d9f0d3&amp;#39;,&amp;#39;#a6dba0&amp;#39;,
                     &amp;#39;#5aae61&amp;#39;,&amp;#39;#1b7837&amp;#39;,&amp;#39;#00441b&amp;#39;) #from colorbrewer2.org&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;plots&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Plots&lt;/h2&gt;
&lt;div id=&#34;testing-activity-and-new-cases&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Testing activity and new cases&lt;/h3&gt;
&lt;p&gt;The capacity to identify confirm cases is limited by the testing capacity; therefore, it helps to look at both testing and positive cases simultaneously, whether in absolute or relative terms.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;df %&amp;gt;% select(date, regions, tamponi, nuovi_attualmente_positivi) %&amp;gt;% 
  group_by(regions) %&amp;gt;% 
  arrange(date) %&amp;gt;% 
  mutate(new_tests = tamponi - lag(tamponi, 1)) %&amp;gt;% 
  ungroup() %&amp;gt;% select(-tamponi) %&amp;gt;% 
  gather(key = &amp;#39;variable&amp;#39;, value = &amp;#39;value&amp;#39;, -regions, -date) %&amp;gt;% 
  mutate(variable = ifelse(variable == &amp;#39;new_tests&amp;#39;, &amp;#39;New tests&amp;#39;, &amp;#39;New positive cases&amp;#39;)) %&amp;gt;% 
  ggplot(., aes(x = date, y = value/1000, colour = variable)) + geom_point() + geom_line() + 
  facet_wrap(~regions, scales = &amp;#39;free_y&amp;#39;) + 
  theme(axis.text.x = element_text(angle = 90)) + 
  labs(x = &amp;#39;Date&amp;#39;, y = &amp;#39;thousands&amp;#39;, colour = &amp;#39;&amp;#39;) + 
  scale_colour_brewer(palette = &amp;#39;Set1&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: Removed 21 rows containing missing values (geom_point).&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: Removed 1 row(s) containing missing values (geom_path).&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://nurfatimaj.com/project/COVID-19/index_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;df %&amp;gt;% mutate(positive_share = totale_attualmente_positivi/tamponi) %&amp;gt;% 
  ggplot(., aes(x = date, y = positive_share*100, colour = &amp;#39;Positive cases as a share of total tested&amp;#39;)) + 
  geom_point() + geom_line() + 
  facet_wrap(~regions, scales = &amp;#39;free_y&amp;#39;) + 
  theme(axis.text.x = element_text(angle = 90)) + 
  labs(x = &amp;#39;Date&amp;#39;, y = &amp;#39;%&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: Removed 15 rows containing missing values (geom_point).&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://nurfatimaj.com/project/COVID-19/index_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;But it is still difficult to make conclusions because of selection issues.
And increase in the share of positive cases in all tested may either of the two:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;more people are getting infected&lt;/li&gt;
&lt;li&gt;tests are given to those most likely to have the virus.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;death-rate-and-new-death-cases&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Death rate and new death cases&lt;/h3&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;df %&amp;gt;% mutate(death_rate = deceduti/totale_casi) %&amp;gt;% 
  ggplot(., aes(x = date, y = death_rate*100, colour = &amp;#39;Death rate&amp;#39;)) + geom_point() + geom_line() + 
  facet_wrap(~regions, scales = &amp;#39;fixed&amp;#39;) + 
  theme(axis.text.x = element_text(angle = 90)) + 
  labs(x = &amp;#39;Date&amp;#39;, y = &amp;#39;%&amp;#39;, colour = &amp;#39;&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: Removed 73 rows containing missing values (geom_point).&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: Removed 1 row(s) containing missing values (geom_path).&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://nurfatimaj.com/project/COVID-19/index_files/figure-html/unnamed-chunk-8-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;df %&amp;gt;% group_by(regions) %&amp;gt;% arrange(date) %&amp;gt;% 
  mutate(new_death = deceduti - lag(deceduti, 1)) %&amp;gt;% 
  ungroup() %&amp;gt;% 
  ggplot(., aes(x = date, y = new_death, fill = regions)) + geom_bar(position = &amp;#39;stack&amp;#39;, stat = &amp;#39;identity&amp;#39;) + 
  scale_fill_manual(values = myColourPalette) + 
  labs(x = &amp;#39;Date&amp;#39;, y = &amp;#39;New death cases&amp;#39;, fill = &amp;#39;Regions&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: Removed 21 rows containing missing values (position_stack).&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://nurfatimaj.com/project/COVID-19/index_files/figure-html/unnamed-chunk-9-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggsave(filename = &amp;#39;featured.png&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Saving 7 x 5 in image&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: Removed 21 rows containing missing values (position_stack).&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;timeline-on-a-map&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Timeline on a map&lt;/h3&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ndays &amp;lt;- min(df$date) %--% max(df$date) / ddays(1) + 1
map &amp;lt;- df_sf %&amp;gt;% 
  mutate(death_rate = deceduti/totale_casi) %&amp;gt;% 
  ggplot(.) + 
  geom_sf(data = shape, fill = NA) + 
  geom_sf(aes(color = death_rate*100, size = death_rate*100)) + 
  theme_void() + 
  labs(title = &amp;#39;Date: {frame_time}&amp;#39;, colour = &amp;#39;Death rate&amp;#39;, size = &amp;#39;Death rate&amp;#39;) + 
  scale_colour_distiller(palette = &amp;#39;Spectral&amp;#39;) + 
  transition_time(date) 
#animate(map, nframes = 30, renderer = gifski_renderer(&amp;#39;map_png/map_anim.gif&amp;#39;))
animate(map, nframes = ndays, fps = 30, renderer = file_renderer(&amp;#39;map_png/&amp;#39;, overwrite = TRUE))
gifski::gifski(list.files(&amp;#39;map_png/&amp;#39;, full.names = &amp;#39;TRUE&amp;#39;), gif_file = &amp;#39;map_anim.gif&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;map_anim.gif&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>
